__meta_vars__:
  - month_full: (january|february|march|april|may|june|july|august|september|october|november|december)
  - month_abbr: (jan|feb|mar|apr|may|jun|jul|aug|sept|oct|nov|dec)
  - month: ({month_full}|{month_abbr})
  - cardinal_suffix: (st|nd|rd|th)
  - early_late_mid: (the)? (early|late|mid -?)
  - match_year: (?P<year>\d{{4}})
  - match_month: (?P<month>{month})
  - schema:
      year: http://www.w3.org/2001/XMLSchema#gYear
      month: http://www.w3.org/2001/XMLSchema#gMonth
      yearMonth: http://www.w3.org/2001/XMLSchema#gYearMonth
      monthDay: http://www.w3.org/2001/XMLSchema#gMonthDay
      date: http://www.w3.org/2001/XMLSchema#date
      duration: http://www.w3.org/2001/XMLSchema#duration

__meta_funcs__:
  - >
    def index_in_or(or_pattern, element):
        return or_pattern[1:-1].split('|').index(element)

  - >
    def month_to_num(month):
        """ january -> 1, february -> 2, ..., december -> 12 """
        try:
            return index_in_or(meta_vars['month_full'], month) + 1
            return index_in_or(meta_vars['month_abbr'], month) + 1
        except ValueError:
            return month

Time:
  - (in|by) {early_late_mid}? {match_month}? {match_year}: >
      '"{}-{:02d}"^^<{schema}>'.format(
        match.group('year'),
        month_to_num(match.group('month')),
        schema=schema['yearMonth']
      ) if match.group('month') else
      '"{}"^^<{schema}>'.format(
        match.group('year'),
        schema=schema['year']
      )

  - (?P<day>\d{{1,2}}){cardinal_suffix}? (of)? {match_month} {match_year}: >
      '"{}-{:02d}-{:02d}"^^<{schema}>'.format(
        match.group('year'),
        month_to_num(match.group('month')),
        int(match.group('day')),
        schema=schema['date']
      )

  - (?P<month>{month}) (?P<day>\d{{1,2}}){cardinal_suffix}?, {match_year}: >
      '"{}-{:02d}-{:02d}"^^<{schema}>'.format(
          match.group('year'),
          month_to_num(match.group('month')),
          int(match.group('day')),
          schema=schema['date']
        )

  - (c\.|on|about|the|of|circa|around|year) {match_year}: >
      '"{}"^^<{schema}>'.format(
        match.group('year'),
        schema=schema['year']
      )

Duration:
  - from {early_late_mid}? (?P<y1>\d{{4}}) to {early_late_mid}? (?P<y2>\d{{4}}): >
      {
        'duration': '"P{}Y"^^<{schema}>'.format(
          int(match.group('y2')) - int(match.group('y1')),
          schema=schema['duration']
        ),
        'start': '"{}"^^<{schema}>'.format(
          match.group('y1'),
          schema=schema['year']
        ),
        'end': '"{}"^^<{schema}>'.format(
          match.group('y2'),
          schema=schema['year']
        ),
      }

  - until {early_late_mid}? {match_year}: >
      {
        'end': '"{}"^^<{schema}>'.format(
          match.group('year'),
          schema=schema['year']
        )
      }

  - during {early_late_mid}? {match_year}(?P<decade>s?): >
      {
        'duration': '"P{}Y"^^<{}>'.format(
          10 if match.group('decade') else 1,
          schema['duration']
        ),
        'start': '"{}"^^<{schema}>'.format(
          match.group('year'),
          schema=schema['year']
        ),
        'end': '"{}"^^<{schema}>'.format(
          int(match.group('year')) + (9 if match.group('decade') else 1),
          schema=schema['year']
        ),
      }

  - (began in|started in|from|since) {early_late_mid}? {match_year}s?: >
      {
        'start': '"{}"^^<{schema}>'.format(
          match.group('year'),
          schema=schema['year']
        )
      }

  - between {early_late_mid}? (?P<y1>\d{{4}}) and {early_late_mid}? (?P<y2>\d{{4}}): >
      {
       'duration': '"P{}Y"^^<{schema}>'.format(
         int(match.group('y2')) - int(match.group('y1')),
         schema=schema['duration']
       ),
       'start': '"{}"^^<{schema}>'.format(
         match.group('y1'),
         schema=schema['year']
       ),
       'end': '"{}"^^<{schema}>'.format(
         match.group('y2'),
         schema=schema['year']
       ),
      }